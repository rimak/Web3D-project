<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>

  <link rel="stylesheet" href="assets/css/reset.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <link rel="stylesheet" href="assets/css/style.css">

</head>
<body>
  <div id="main">
    <div id=menu>
      <button type="submit" id="start">START</button>
    </div>
    <div id="game">
      <img src="assets/img/moveRight.png" alt="" class="hidden">
      <img src="assets/img/moveLeft.png" alt="" class="hidden">
      <img src="assets/img/decor.jpg" alt="map" id ="map">
      <img src="assets/img/character.png" alt="character" id="character">
      <img src="assets/img/couteau.png" alt="knive" id ="Right" class="couteau">
      <img src="assets/img/couteau.png" alt="knive" id ="RightMid" class="couteau">
      <img src="assets/img/couteau.png" alt="knive" id ="LeftMid" class="couteau">
      <img src="assets/img/couteau.png" alt="knive" id ="Left" class="couteau">
      <img src="assets/img/copain_simon1.png" alt="character" id="copain1">
      <img src="assets/img/copain_simon2.png" alt="character" id="copain2">

    </div>
  </div>
  <script type="text/javascript">

  $(document).ready(function(e){
    // si l'objet game existe déjà on l'utilise
    var game = game || {};
    // propriété character de l'objet game
    game.character = {
      // initialisation des propriétés de game.character
      $character : {},
      $game : {},

      $start : {},
      mousePosition : {},
      gameSettings : {},

      //constructeur
      init: function(e) {
        this.$start = $("start");
        this.$character = $("#character");
        this.$game = $("#map");
      },
      getMousePosition: function(e) {
        this.mousePosition = {
          // on assigne à game.character.mouseposition les propiétés suivantes
          y: e.pageY,
          x: e.pageX
        }
      },
      getGameSettings: function() {
        // récupération de la width du character et des offsets
        this.gameSettings = {
          width: game.character.$game.width(),
          position: game.character.$game.offset(),
          characterPosition: game.character.$character.offset()
        }
      },
      move: function() {
        var leftPos = 0;
        leftPos = this.mousePosition.x;

        // On enlève la moitié de la largeur du character pour éviter les décallage
        leftPos = leftPos - this.$character.width();

        if(leftPos <= 350) {
          leftPos = 350;
        }
          this.$character.css('left', leftPos);
      }
    }

    game.knives = {
      $knive : {},
      $knives : {},
      kniveSettings: {},


      init: function()  {
        this.$knives = $(".couteau");
      },
      //
      getKniveSettings: function()  {
        this.kniveSettings = {
          count : 0,
          random : Math.floor(Math.random()*2),
          pos : $this.$knives.offset()
        }
      },
      //
      kniveFall: function()  {
        setTimeout(function(){
          var btm = this.$knive.css('bottom');
          btm -= 10;
        }, 10 );
      },
      //
      getStarted: function(x)  {

        // la boucle fait planter, j'ai essayé de faire un truc qui dit
            setTimeout(function() {
              setInterval(function() { this.kniveFall(); }, 1000);
            }, 180000);
        if(keepGoing = false){
          console.log("You loose !")
        }
      }
    }

    game.character.init(e);
    game.character.getGameSettings();
    game.knives.init();


    $('#game').on('mousemove', function(e){
      game.character.getMousePosition(e);
      $('#map').on('mousemove', function(e){
      game.character.move();
      });
    });
    $('#start').on('click', function(){
      game.knives.getStarted();
    });

    console.log(game);

  });
  </script>

</body>
</html>
